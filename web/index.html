<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Comfy Dungeon</title>

		<link rel="stylesheet" type="text/css" href="/dungeon/css/uikit.min.css">
		<link rel="stylesheet" type="text/css" href="/dungeon/css/dungeon.css?v=0.1.0">
	</head>
	<body>
    <!-- LEFT BAR -->
    <aside id="left-col" class="uk-light uk-visible@m">
      <h4 class="uk-text-center uk-margin-remove-vertical text-light">Comfy Dungeon<small><sup> v0.1.1</sup></small></h4>

      <div class="left-content-box left-nav-wrap">
        <form class="uk-grid-small">
          <div uk-accordion="collapsible: false">
            <div>
              <a class="uk-accordion-title" href>Generation params</a>

              <div class="uk-accordion-content uk-grid-small" uk-grid>
                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="quality-input">Quality</label>
                  <input class="uk-range" id="quality-input" type="range" value="1" min="0.0" max="1.0" step="0.25" aria-label="Range">
                  <div class="uk-form-label uk-text-muted" uk-grid><div class="uk-width-1-2@s"><span uk-icon="icon: arrow-left"></span>Speed</div><div class="uk-width-1-2@s" style="text-align:right;">Accuracy<span uk-icon="icon: arrow-right"></span></div></div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="batch-size-input">Results per generation</label>
                  <input class="uk-range" id="batch-size-input" type="range" value="1" min="1" max="4" step="1" aria-label="Range" list="batch-size-values">
                  <datalist id="batch-size-values" class="uk-form-label uk-text-muted">
                    <option value="0" label="1"></option>
                    <option value="33" label="2"></option>
                    <option value="66" label="3"></option>
                    <option value="100" label="4"></option>
                  </datalist>
                </div>

                <div class="uk-width-1-1@s">
                  <label class="uk-form-label" for="style-input">Preset</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="style-input" aria-label="Select">
                    </select>
                  </div>
                </div>  
              </div>
            </div>

            <div>
              <a class="uk-accordion-title" href>Scene</a>

              <div class="uk-accordion-content uk-grid-small" uk-grid>
                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="setting-select">Setting</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="setting-input" aria-label="Select">
                    </select>
                  </div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="background-input">Background</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="background-input" aria-label="Select">
                    </select>
                  </div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="mood-input">Mood</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="mood-input" aria-label="Select">
                    </select>
                  </div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="atmosphere-input">Color hint</label>
                  <button uk-icon="icon: question" type="button"></button>
                  <div class="uk-card uk-card-small uk-card-body uk-card-default" uk-drop="pos: right-top; mode: click;">The picture will have a predominant color.</div>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="atmosphere-input" aria-label="Select">
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div>
              <a class="uk-accordion-title" href>Character</a>

              <div class="uk-accordion-content uk-grid-small" uk-grid>
                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="gender-input">Gender</label>
                  <button uk-icon="icon: question" type="button"></button>
                  <div class="uk-card uk-card-small uk-card-body uk-card-default" uk-drop="pos: right-top; mode: click;">Femininity/Masculinity slider trait is tentative, the result may not be what you expect.</div>
                  <input class="uk-range" id="gender-input" type="range" value="0" min="0" max="3" step="1" aria-label="Range">
                  <div class="uk-form-label uk-grid-small uk-text-muted" uk-grid><div class="uk-width-1-2@s"><span uk-icon="icon: arrow-left"></span>Femininity</div><div class="uk-width-1-2@s" style="text-align:right;">Masculinity<span uk-icon="icon: arrow-right"></span></div></div>
                </div>
                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="age-input">Age</label>
                  <input class="uk-range" id="age-input" type="range" value="1" min="0" max="3" step="1" aria-label="Range">
                  <div class="uk-form-label uk-grid-small uk-text-muted" uk-grid><div class="uk-width-1-2@s"><span uk-icon="icon: arrow-left"></span>Young</div><div class="uk-width-1-2@s" style="text-align:right;">Old<span uk-icon="icon: arrow-right"></span></div></div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="body-structure-input">Body structure</label>
                  <input class="uk-range" id="body-structure-input" type="range" value="1" min="0" max="3" step="1" aria-label="Range">
                  <div class="uk-form-label uk-grid-small uk-text-muted" uk-grid><div class="uk-width-1-2@s"><span uk-icon="icon: arrow-left"></span>Slender</div><div class="uk-width-1-2@s" style="text-align:right;">Chubby<span uk-icon="icon: arrow-right"></span></div></div>
                </div>
                <div class="uk-width-1-2@s"></div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="race-input">Race</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="race-input" aria-label="Select">
                    </select>
                  </div>
                </div>
                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="ethnicity-input">Ethnic bias</label>
                  <button uk-icon="icon: question" type="button"></button>
                  <div class="uk-card uk-card-small uk-card-body uk-card-default" uk-drop="pos: right-top; mode: click;">Adds a random ethnicity to the character based on the area selected. It's a light conditioning that helps making the generations more interesting; it doesn't guarantee an exact nationality.</div>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="ethnicity-input" aria-label="Select">
                    </select>
                  </div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="class-input">Class</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="class-input" aria-label="Select">
                    </select>
                  </div>
                </div>
                
                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="gear-input">Clothing/Armor</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="gear-input" aria-label="Select">
                    </select>
                  </div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="hairstyle-input">Hairstyle</label>
                  <button uk-icon="icon: question" type="button"></button>
                  <div class="uk-card uk-card-small uk-card-body uk-card-default" uk-drop="pos: right-top; mode: click;">Please note that some hairstyles work better (or at all) with a specific gender and/or ethnicity.</div>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="hairstyle-input" aria-label="Select">
                    </select>
                  </div>
                </div>

                <div class="uk-width-1-2@s">
                  <label class="uk-form-label" for="haircolor-input">Hair color</label>
                  <div class="uk-form-controls">
                    <select class="uk-select" id="haircolor-input" aria-label="Select">
                    </select>
                  </div>
                </div>

              </div>
            </div>

            <div>
              <a class="uk-accordion-title" href>Custom</a>

              <div class="uk-accordion-content uk-grid-small" uk-grid>

                <div class="uk-width-1-1@s">
                  <label class="uk-form-label" for="custom-input">Custom prompt</label>
                  <button uk-icon="icon: question" type="button"></button>
                  <div class="uk-card uk-card-small uk-card-body uk-card-default" uk-drop="pos: right-top; mode: click;">Keep it simple. Don't be too discoursive, write the element that you'd want to add. Eg: "red scarf" or "silver tiara". You might need to add strength with the syntax "(silver tiara:1.2)".<br/>If the element is generic and could be misinterpreted try to give context. Eg: instead of "crown" try with "wearing a silver crown on his head".</div>
                  <div class="uk-form-controls">
                    <textarea name="custom-input" class="uk-textarea" id="custom-input" rows="3" placeholder="Add a custom element" aria-label="Textarea"></textarea>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </form>
      </div>
    </aside>
    <script>
        populateComboFromJsonFile("style-input", "/dungeon/json/preset.json");
        populateComboFromJsonFile("setting-input", "/dungeon/json/settings.json");
        populateComboFromJsonFile("background-input", "/dungeon/json/backgrounds.json");
        populateComboFromJsonFile("mood-input", "/dungeon/json/mood.json");
        populateComboFromJsonFile("atmosphere-input", "/dungeon/json/atmosphere.json");
        populateComboFromJsonFile("race-input", "/dungeon/json/race.json");
        populateComboFromJsonFile("ethnicity-input", "/dungeon/json/ethnicity.json");
        populateComboFromJsonFile("class-input", "/dungeon/json/class.json");
        populateComboFromJsonFile("gear-input", "/dungeon/json/gear.json");
        populateComboFromJsonFile("hairstyle-input", "/dungeon/json/hairstyle.json");
        populateComboFromJsonFile("haircolor-input", "/dungeon/json/haircolor.json");

        function populateComboFromJsonFile(comboName, url) {
            fetch(url, { method: 'GET' })
                .then(function (response) {
                    return response.json();
                })
                .then(function (json) {
                    appendData(json);
                })
                .catch(function (err) {
                    console.log('error: ' + err + 'when reading:' + url);
                });
            function appendData(json) {
                let ele = document.getElementById(comboName);

                for (let i in json['data']) {
                    let val = json['data'][i][0];
                    let txt = json['data'][i][1] == "" ? val : json['data'][i][1];

                    ele.innerHTML = ele.innerHTML + '<option value="' + val + '">' + txt + '</option > ';

                }
            }
        }
    </script>
    <!-- /LEFT BAR -->
  
    <!-- CONTENT -->
    <div id="content" class="uk-light" data-uk-height-viewport="expand: true">
      <progress id="main-progress" class="progress" value="0" max="0"></progress>

      <div class="uk-text-center uk-container uk-container-expand">
        <form><button id="roll" class="uk-button uk-button-danger" type="button"><span id="main-spinner" uk-spinner="ratio: 0.7" style="display: none;"></span><span id="roll-icon" uk-icon="icon: bolt"></span>&nbsp;Roll</button><input id="main-seed" class="uk-input" type="text" placeholder="Seed" aria-label="Seed" value="0"><label>Random <input id="is-random" class="uk-checkbox" type="checkbox" checked></label></form>
      </div>

      <div id="results" class="uk-child-width-expand uk-text-center" uk-grid uk-lightbox></div>
    </div>
    <!-- /CONTENT -->

    <!-- MODAL -->
    <div id="app-modal" uk-modal>
      <div class="uk-modal-dialog uk-modal-body">
        <h2 class="uk-modal-title">An error occurred</h2>
        <p id="modal-message"></p>
        <p class="uk-text-center">
          <button class="uk-button uk-button-default uk-modal-close" type="button">Close</button>
        </p>
      </div>
    </div>
    <!-- /MODAL -->

    <script src="/dungeon/js/uikit.min.js"></script>
		<script src="/dungeon/js/uikit-icons.min.js"></script>
    <script src="/dungeon/js/dungeon.js"></script>
  </body>
</html>